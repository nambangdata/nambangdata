(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d228bf9"],{db05:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Dashboard",[a("div",[a("div",{staticClass:"mb-4 text-white"},[a("h5",[t._v("File Terkait Dokumen")]),a("small",[t._v("File Terkait Dokumen")])]),a("div",{staticClass:"card mb-2"},[null!=t.document?a("div",{staticClass:"card-body"},[a("router-link",{attrs:{to:"/permit"}},[a("i",{staticClass:"fas fa-arrow-left"}),t._v(" Kembali ke list")]),a("hr"),a("table",{staticClass:"table table-bordered"},[a("tbody",[a("tr",[a("td",{attrs:{width:"20%"}},[t._v("Kode Dokumen")]),a("td",[t._v(t._s(t.document.number))])]),a("tr",[a("td",[t._v("Nama Dokumen")]),a("td",[t._v(t._s(t.selectedData(t.docPermitNames,t.document.permitId)))])]),a("tr",[a("td",[t._v("Deskripsi Dokumen")]),a("td",[t._v(t._s(t.document.description))])])])])],1):t._e()]),a("div",{staticClass:"card mb-2"},[a("div",{staticClass:"card-body"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-8"},[a("h5",[t._v("File")]),a("p",[t._v("file terkait untuk dokumen")])]),a("div",{staticClass:"col-md-4 text-right"},[a("button",{staticClass:"btn btn-success",on:{click:t.chooseFile}},[a("i",{staticClass:"fas fa-upload"}),t._v(" Upload File")])])]),a("hr"),a("table",{staticClass:"table table-bordered"},[a("thead",[a("tr",[a("th",[t._v("No")]),a("th",[t._v("Nama File")]),a("th",[t._v("Download")])])]),a("tbody",[0==t.files.length?a("tr",[a("td",{staticClass:"text-center",attrs:{colspan:"3"}},[t._v("Belum Ada File")])]):t._l(t.files,(function(e,n){return a("tr",{key:n},[a("td",{attrs:{width:"5%"}},[t._v(t._s(n+1))]),a("td",{attrs:{width:"80%"}},[t._v(t._s(e.path))]),a("td",{attrs:{width:"15%"}},[a("a",{staticClass:"btn btn-sm btn-success",attrs:{href:t.downloadFile(e.path)}},[a("i",{staticClass:"fas fa-download"})]),a("button",{staticClass:"btn btn-sm btn-danger ml-1",on:{click:function(a){return t.doDelete(e.id)}}},[a("i",{staticClass:"fas fa-trash"})])])])}))],2)])])]),a("div",{staticClass:"modal fade",attrs:{id:"modalAdd",tabindex:"-1",role:"dialog","aria-labelledby":"modalStatus","aria-hidden":"true"}}),a("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"file-input"},on:{change:function(e){return t.uploadDoc(e)}}})])])},i=[],r=(a("4160"),a("b0c0"),a("ac1f"),a("5319"),a("1276"),a("159b"),a("96cf"),a("1da1")),s=a("cc57"),o=a("c6db"),l=a("3686"),c=a("424e"),d=a("a93f"),u="/api/file",h=function(t,e){return d["b"].post(u+"/upload/"+t,e)},p=function(t){return d["a"].get(u+"/all/document_id/"+t)},m=function(t){return d["a"].delete(u+"/id/"+t)},f={name:"Attachment",data:function(){return{document:null,files:[],docPermitNames:[]}},props:["id"],mixins:[s["a"],o["a"],l["a"]],mounted:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getDocPermitName();case 2:t.docPermitNames=e.sent,t.getDocument();case 4:case"end":return e.stop()}}),e)})))()},methods:{getDocument:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return $("#file-input").val(""),t.showLoading(),t.document=null,t.schedules=[],e.prev=4,e.next=7,Object(c["c"])(t.id);case 7:return a=e.sent,t.document=a.data[0].document,e.next=11,t.getUploadedFile();case 11:e.next=19;break;case 13:e.prev=13,e.t0=e["catch"](4),console.log(e.t0),t.hideLoading(),t.showAlert("Gagal Mendapatkan Data","error"),401==(null===(n=error.response)||void 0===n?void 0:n.status)&&t.invalidSession();case 19:case"end":return e.stop()}}),e,null,[[4,13]])})))()},getUploadedFile:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.files=[],e.prev=1,e.next=4,p(t.id);case 4:a=e.sent,t.hideLoading(),n=a.data,n.forEach((function(e,a){t.files.push(e.fileAttachment[0])})),e.next=15;break;case 10:e.prev=10,e.t0=e["catch"](1),console.log(e.t0),t.hideLoading(),t.showAlert("Gagal Mendapatkan Data","error");case 15:case"end":return e.stop()}}),e,null,[[1,10]])})))()},chooseFile:function(){$("#file-input").click()},uploadDoc:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var n,i,r,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return $(t.target),n=t.target.files[0],["jpg","JPG","png","PNG","pdf","jpeg"],n.name.split(".").pop(),n.size/1e3,e.showLoading(),a.prev=6,i=new FormData,i.append("file",n),a.next=11,h(e.id,i);case 11:r=a.sent,e.hideLoading(),$("#file-input").val(""),e.showAlert(r.data),e.getDocument(),a.next=25;break;case 18:a.prev=18,a.t0=a["catch"](6),$("#file-input").val(""),console.log(a.t0),e.hideLoading(),e.showAlert("Gagal Mengupload File","error"),401==(null===(s=error.response)||void 0===s?void 0:s.status)&&e.invalidSession();case 25:case"end":return a.stop()}}),a,null,[[6,18]])})))()},doDelete:function(t){var e=this;this.$swal({title:"Hapus Data",text:"Yakin ingin menghapus file ?",type:"error",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes"}).then((function(a){if(a.value){e.showLoading();var n=m(t);n.then((function(t){e.hideLoading(),e.$toast.open({message:"File Berhasil Dihapus !",type:"info",position:"top-right"}),e.getDocument()})).catch((function(t){var a;e.hideLoading(),e.showNotif("Terjadi Kesalahan"),console.log(t),401==(null===(a=t.response)||void 0===a?void 0:a.status)&&e.invalidSession()}))}}))},invalidSession:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return alert("Sesi sudah tidak valid, silahkan login"),e.next=3,t.$store.dispatch("auth/authLogout");case 3:t.$router.replace("/login");case 4:case"end":return e.stop()}}),e)})))()}}},v=f,g=a("2877"),b=Object(g["a"])(v,n,i,!1,null,null,null);e["default"]=b.exports}}]);
//# sourceMappingURL=chunk-2d228bf9.995ae127.js.map